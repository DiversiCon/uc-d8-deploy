langcode: en
status: true
id: migrate_content_story
class: Drupal\migrate\Plugin\Migration
field_plugin_method: null
cck_plugin_method: null
migration_tags:
  - 'Drupal 7'
  - Content
migration_group: legacy
label: 'Content: Story'
source:
  plugin: d7_node_story
  node_type: uniquely_chicago
  constants:
    format: basic_html
    academics: 2
    news: 7
process:
  nid: tnid
  vid: vid
  langcode:
    plugin: default_value
    source: language
    default_value: und
  title: title
  field_headline_text: title
  uid: node_uid
  status: status
  moderation_state:
    plugin: static_map
    source: status
    bypass: true
    map:
      1: published
      'TRUE': published
      '1': published
  created: created
  changed: changed
  promote: promote
  sticky: sticky
  revision_uid: revision_uid
  revision_log: log
  revision_timestamp: timestamp
  smartbody_ids:
    plugin: migration_lookup
    migration: migrate_content_story_smartbody
    source: nid
  field_par_smartbody/target_id:
    plugin: extract
    source: '@smartbody_ids'
    index:
    - 0
  field_par_smartbody/target_revision_id:
    plugin: extract
    source: '@smartbody_ids'
    index:
    - 1
  body/value: preview_text
  body/format: constants/format
  field_image_main/target_id:
    plugin: migration_lookup
    migration: migrate_media_image
    source: field_image/0/fid
  field_byline/target_id:
    plugin: migration_lookup
    migration: migrate_entity_contributors
    source: field_submitted_by/0/target_id
  field_date_no_time:
    plugin: format_date
    source: post_date
    from_format: 'Y-m-d H:i:s'
    to_format: 'Y-m-d'
    settings:
      validate_format: false
  field_section/target_id: constants/news


#  test:
#    plugin: extract
#    source: field_submitted_by
#    index:
#      - target_id
#  debug:
#    plugin: debug_migrate
#    source: byline
#  debug2:
#    plugin: debug_migrate
#    source: field_submitted_by/0/target_id


#  field_tag_reference:
#    plugin: sub_process
#    source: field_tags
#    process:
#      target_id: tid
#  field_section/target_id: constants/academics
#  field_program_type:
#    plugin: sub_process
#    source: field_program_type
#    process:
#      target_id: tid
#  links:
#    plugin: combine_program_links
#    source:
#      catalog_link: field_catalog_link
#     program_page: field_program_page
#      mailing_list: field_mailing_list
#      related_links: field_related_links
#  field_links_ultd:
#    plugin: iterator
#    source: '@links'
#    process:
#      title: title
#      uri: url



#  field_media_contact:
#    plugin: sub_process
#    source: field_story_media_contact
#    process:
#      target_id: target_id
#  hero_ids:
#    plugin: migration_lookup
#    migration: migrate_content_story_hero_image
#    no_stub: true
#   source: nid
#  field_paragraph_single/target_id:
#    plugin: extract
#    source: '@hero_ids'
#    index:
#      - 0
#  field_paragraph_single/target_revision_id:
#    plugin: extract
#   source: '@hero_ids'
#    index:
#      - 1
destination:
  plugin: 'entity:node'
  default_bundle: story
migration_dependencies:
  required:
    - migrate_users
  optional:
    - d7_field_instance
dependencies:
  module:
    - uc_migrate
  enforced:
    module:
      - uc_migrate


# title                       title
#                             field_headline_text
# field_photoset
# field_embedded_feature      video?
# field_post_date             date add scheduled publish date
# field_class
# field_major_degree
# field_pullquote             pullquote::field_body
# field_citation_name         pullquote::field_subheadline_text
# field_citation_title        pullquote::field_subheadline_text (with <br /> separator)
# field_quote_placement       smartbody::field_smartbody_text (attempt to place <hr />)
# field_submitted_by
# field_photo_by
# field_image
# field_blurb
# body
# field_related_links
# field_attachments
# field_story_tags
#                             body (needs to be populated with something)

# Related links
# Pull quote
# Byline
# Contributors
